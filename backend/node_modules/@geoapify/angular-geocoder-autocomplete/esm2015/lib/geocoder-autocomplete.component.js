import { Component, ViewChild, Input, Output, EventEmitter, Inject } from '@angular/core';
import { GeocoderAutocomplete } from '@geoapify/geocoder-autocomplete';
import { GEOAPIFY_CONFIG } from './geoapify-config';
export class GeocoderAutocompleteComponent {
    constructor(config) {
        this.config = config;
        this.placeSelect = new EventEmitter();
        this.suggestionsChange = new EventEmitter();
    }
    ngOnInit() {
    }
    ngAfterViewInit() {
        const options = {};
        if (this.placeholder) {
            options.placeholder = this.placeholder;
        }
        if (this.type) {
            options.type = this.type;
        }
        if (this.lang) {
            options.lang = this.lang;
        }
        if (this.limit) {
            options.limit = this.limit;
        }
        if (this.debounceDelay) {
            options.debounceDelay = this.debounceDelay;
        }
        if (this.skipIcons) {
            options.skipIcons = this.skipIcons;
        }
        if (this.skipDetails) {
            options.skipDetails = this.skipDetails;
        }
        this.autocomplete = new GeocoderAutocomplete(this.container.nativeElement, this.config.apiKey, options);
        if (this.value) {
            this.autocomplete.setValue(this.value);
        }
        if (this.countryCodes) {
            console.warn("WARNING! Obsolete function called. The  'countryCodes' input has been deprecated, please use the new 'filterByCountryCode' input instead!");
            this.autocomplete.addFilterByCountry(this.countryCodes);
        }
        if (this.position) {
            console.warn("WARNING! Obsolete function called. The  'position' input has been deprecated, please use the new 'biasByLocation' input instead!");
            this.autocomplete.addBiasByProximity(this.position);
        }
        if (this.filterByCircle) {
            this.autocomplete.addFilterByCircle(this.filterByCircle);
        }
        if (this.filterByCountryCode) {
            this.autocomplete.addFilterByCountry(this.filterByCountryCode);
        }
        if (this.filterByRect) {
            this.autocomplete.addFilterByRect(this.filterByRect);
        }
        if (this.biasByCircle) {
            this.autocomplete.addBiasByCircle(this.biasByCircle);
        }
        if (this.biasByRect) {
            this.autocomplete.addBiasByRect(this.biasByRect);
        }
        if (this.biasByProximity) {
            this.autocomplete.addBiasByProximity(this.biasByProximity);
        }
        if (this.biasByCountryCode) {
            this.autocomplete.addBiasByCountry(this.biasByCountryCode);
        }
        if (this.preprocessingHook) {
            this.autocomplete.setPreprocessHook(this.preprocessingHook);
        }
        if (this.postprocessingHook) {
            this.autocomplete.setPostprocessHook(this.postprocessingHook);
        }
        if (this.suggestionsFilter) {
            this.autocomplete.setSuggestionsFilter(this.suggestionsFilter);
        }
        this.autocomplete.on('select', this.onSelect.bind(this));
        this.autocomplete.on('suggestions', this.onSuggestions.bind(this));
    }
    onSelect(value) {
        this.placeSelect.emit(value);
    }
    onSuggestions(value) {
        this.suggestionsChange.emit(value);
    }
    ngOnChanges(changes) {
        if (!this.autocomplete) {
            return;
        }
        if (changes['value'] &&
            !changes['value'].isFirstChange()) {
            this.autocomplete.setValue(changes['value'].currentValue);
        }
        if (changes['type'] &&
            !changes['type'].isFirstChange()) {
            this.autocomplete.setType(changes['type'].currentValue);
        }
        if (changes['lang'] &&
            !changes['lang'].isFirstChange()) {
            this.autocomplete.setLang(changes['lang'].currentValue);
        }
        if (changes['filterByCircle'] &&
            !changes['filterByCircle'].isFirstChange()) {
            this.autocomplete.addFilterByCircle(changes['filterByCircle'].currentValue);
        }
        if (changes['filterByCountryCode'] &&
            !changes['filterByCountryCode'].isFirstChange()) {
            this.autocomplete.addFilterByCountry(changes['filterByCountryCode'].currentValue);
        }
        if (changes['filterByRect'] &&
            !changes['filterByRect'].isFirstChange()) {
            this.autocomplete.addFilterByRect(changes['filterByRect'].currentValue);
        }
        if (changes['biasByCircle'] &&
            !changes['biasByCircle'].isFirstChange()) {
            this.autocomplete.addBiasByCircle(changes['biasByCircle'].currentValue);
        }
        if (changes['biasByRect'] &&
            !changes['biasByRect'].isFirstChange()) {
            this.autocomplete.addBiasByRect(changes['biasByRect'].currentValue);
        }
        if (changes['biasByProximity'] &&
            !changes['biasByProximity'].isFirstChange()) {
            this.autocomplete.addBiasByProximity(changes['biasByProximity'].currentValue);
        }
        if (changes['biasByCountryCode'] &&
            !changes['biasByCountryCode'].isFirstChange()) {
            this.autocomplete.addBiasByCountry(changes['biasByCountryCode'].currentValue);
        }
        if (changes['countryCodes'] &&
            !changes['countryCodes'].isFirstChange()) {
            console.warn("WARNING! Obsolete function called. The  'countryCodes' input has been deprecated, please use the new 'filterByCountryCode' input instead!");
            this.autocomplete.addFilterByCountry(changes['countryCodes'].currentValue);
        }
        if (changes['position'] &&
            !changes['position'].isFirstChange()) {
            console.warn("WARNING! Obsolete function called. The  'position' input has been deprecated, please use the new 'biasByLocation' input instead!");
            this.autocomplete.addBiasByProximity(changes['position'].currentValue);
        }
        if (changes['limit'] &&
            !changes['limit'].isFirstChange()) {
            this.autocomplete.setLimit(changes['limit'].currentValue);
        }
        if (changes['preprocessingHook'] &&
            !changes['preprocessingHook'].isFirstChange()) {
            this.autocomplete.setPreprocessHook(changes['preprocessingHook'].currentValue);
        }
        if (changes['postprocessingHook'] &&
            !changes['postprocessingHook'].isFirstChange()) {
            this.autocomplete.setPostprocessHook(changes['postprocessingHook'].currentValue);
        }
        if (changes['suggestionsFilter'] &&
            !changes['suggestionsFilter'].isFirstChange()) {
            this.autocomplete.setSuggestionsFilter(changes['suggestionsFilter'].currentValue);
        }
    }
    ngOnDestroy() {
        this.autocomplete.off('select', this.onSelect);
        this.autocomplete.off('suggestions', this.onSuggestions);
    }
}
GeocoderAutocompleteComponent.decorators = [
    { type: Component, args: [{
                selector: 'geoapify-geocoder-autocomplete',
                template: '<div class="geocoder-container" #container></div>',
                styles: ['.geocoder-container {position: relative}']
            },] }
];
GeocoderAutocompleteComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Inject, args: [GEOAPIFY_CONFIG,] }] }
];
GeocoderAutocompleteComponent.propDecorators = {
    container: [{ type: ViewChild, args: ['container',] }],
    value: [{ type: Input }],
    placeholder: [{ type: Input }],
    type: [{ type: Input }],
    skipIcons: [{ type: Input }],
    skipDetails: [{ type: Input }],
    lang: [{ type: Input }],
    filterByCountryCode: [{ type: Input }],
    filterByCircle: [{ type: Input }],
    filterByRect: [{ type: Input }],
    biasByCountryCode: [{ type: Input }],
    biasByCircle: [{ type: Input }],
    biasByRect: [{ type: Input }],
    biasByProximity: [{ type: Input }],
    countryCodes: [{ type: Input }],
    position: [{ type: Input }],
    limit: [{ type: Input }],
    debounceDelay: [{ type: Input }],
    preprocessingHook: [{ type: Input }],
    postprocessingHook: [{ type: Input }],
    suggestionsFilter: [{ type: Input }],
    placeSelect: [{ type: Output }],
    suggestionsChange: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VvY29kZXItYXV0b2NvbXBsZXRlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL2FuZ3VsYXItZ2VvY29kZXItYXV0b2NvbXBsZXRlL3NyYy9saWIvZ2VvY29kZXItYXV0b2NvbXBsZXRlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLFNBQVMsRUFBNEMsS0FBSyxFQUFhLE1BQU0sRUFBRSxZQUFZLEVBQWEsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2xLLE9BQU8sRUFBRSxvQkFBb0IsRUFBbUssTUFBTSxpQ0FBaUMsQ0FBQztBQUN4TyxPQUFPLEVBQWtCLGVBQWUsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBVXBFLE1BQU0sT0FBTyw2QkFBNkI7SUF5RXhDLFlBQTZDLE1BQXNCO1FBQXRCLFdBQU0sR0FBTixNQUFNLENBQWdCO1FBTG5FLGdCQUFXLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFHekQsc0JBQWlCLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7SUFFUSxDQUFDO0lBRXhFLFFBQVE7SUFFUixDQUFDO0lBRUQsZUFBZTtRQUNiLE1BQU0sT0FBTyxHQUFnQyxFQUFFLENBQUM7UUFFaEQsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ3BCLE9BQU8sQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQztTQUN4QztRQUVELElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtZQUNiLE9BQU8sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztTQUMxQjtRQUVELElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtZQUNiLE9BQU8sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztTQUMxQjtRQUVELElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTtZQUNkLE9BQU8sQ0FBQyxLQUFLLEdB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eUJBR0wsS0FBSzs4QkFHTCxLQUFLOzJCQUdMLEtBQUs7dUJBR0wsS0FBSztvQkFHTCxLQUFLOzRCQUdMLEtBQUs7Z0NBR0wsS0FBSztpQ0FHTCxLQUFLO2dDQUdMLEtBQUs7MEJBR0wsTUFBTTtnQ0FHTixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgQWZ0ZXJWaWV3SW5pdCwgU2ltcGxlQ2hhbmdlcywgSW5wdXQsIE9uQ2hhbmdlcywgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIE9uRGVzdHJveSwgSW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBHZW9jb2RlckF1dG9jb21wbGV0ZSwgTG9jYXRpb25UeXBlLCBTdXBwb3J0ZWRMYW5ndWFnZSwgQ291bnR5Q29kZSwgR2VvUG9zaXRpb24sIEdlb2NvZGVyQXV0b2NvbXBsZXRlT3B0aW9ucywgQnlDb3VudHJ5Q29kZU9wdGlvbnMsIEJ5Q2lyY2xlT3B0aW9ucywgQnlSZWN0T3B0aW9ucywgQnlQcm94aW1pdHlPcHRpb25zIH0gZnJvbSAnQGdlb2FwaWZ5L2dlb2NvZGVyLWF1dG9jb21wbGV0ZSc7XG5pbXBvcnQgeyBHZW9hcGlmeUNvbmZpZywgR0VPQVBJRllfQ09ORklHIH0gZnJvbSAnLi9nZW9hcGlmeS1jb25maWcnO1xuXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2dlb2FwaWZ5LWdlb2NvZGVyLWF1dG9jb21wbGV0ZScsXG4gIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz1cImdlb2NvZGVyLWNvbnRhaW5lclwiICNjb250YWluZXI+PC9kaXY+JyxcbiAgc3R5bGVzOiBbXG4gICAgJy5nZW9jb2Rlci1jb250YWluZXIge3Bvc2l0aW9uOiByZWxhdGl2ZX0nXG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgR2VvY29kZXJBdXRvY29tcGxldGVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcblxuICBhdXRvY29tcGxldGU6IEdlb2NvZGVyQXV0b2NvbXBsZXRlO1xuXG4gIEBWaWV3Q2hpbGQoJ2NvbnRhaW5lcicpXG4gIGNvbnRhaW5lcjogRWxlbWVudFJlZjtcblxuICBASW5wdXQoKVxuICB2YWx1ZTogc3RyaW5nO1xuXG4gIEBJbnB1dCgpXG4gIHBsYWNlaG9sZGVyOiBzdHJpbmc7XG5cbiAgQElucHV0KClcbiAgdHlwZTogTG9jYXRpb25UeXBlO1xuXG4gIEBJbnB1dCgpXG4gIHNraXBJY29uczogYm9vbGVhbjtcblxuICBASW5wdXQoKVxuICBza2lwRGV0YWlsczogYm9vbGVhbjtcblxuICBASW5wdXQoKVxuICBsYW5nOiBTdXBwb3J0ZWRMYW5ndWFnZVxuXG4gIEBJbnB1dCgpXG4gIGZpbHRlckJ5Q291bnRyeUNvZGU6IEJ5Q291bnRyeUNvZGVPcHRpb25zO1xuXG4gIEBJbnB1dCgpXG4gIGZpbHRlckJ5Q2lyY2xlOiBCeUNpcmNsZU9wdGlvbnM7XG5cbiAgQElucHV0KClcbiAgZmlsdGVyQnlSZWN0OiBCeVJlY3RPcHRpb25zO1xuXG4gIEBJbnB1dCgpXG4gIGJpYXNCeUNvdW50cnlDb2RlOiBCeUNvdW50cnlDb2RlT3B0aW9ucztcblxuICBASW5wdXQoKVxuICBiaWFzQnlDaXJjbGU6IEJ5Q2lyY2xlT3B0aW9ucztcblxuICBASW5wdXQoKVxuICBiaWFzQnlSZWN0OiBCeVJlY3RPcHRpb25zO1xuXG4gIEBJbnB1dCgpXG4gIGJpYXNCeVByb3hpbWl0eTogQnlQcm94aW1pdHlPcHRpb25zO1xuXG4gIEBJbnB1dCgpXG4gIGNvdW50cnlDb2RlczogQ291bnR5Q29kZVtdOyAgIC8vIGRlcHJlY2F0ZWRcblxuICBASW5wdXQoKVxuICBwb3NpdGlvbjogR2VvUG9zaXRpb247ICAgLy8gZGVwcmVjYXRlZFxuXG4gIEBJbnB1dCgpXG4gIGxpbWl0OiBudW1iZXI7XG5cbiAgQElucHV0KClcbiAgZGVib3VuY2VEZWxheTogbnVtYmVyO1xuXG4gIEBJbnB1dCgpXG4gIHByZXByb2Nlc3NpbmdIb29rOiAodmFsdWU6IHN0cmluZykgPT4gc3RyaW5nO1xuXG4gIEBJbnB1dCgpXG4gIHBvc3Rwcm9jZXNzaW5nSG9vazogKGZlYXR1cmU6IGFueSkgPT4gc3RyaW5nO1xuXG4gIEBJbnB1dCgpXG4gIHN1Z2dlc3Rpb25zRmlsdGVyOiAoc3VnZ2VzdGlvbnM6IGFueVtdKSA9PiBhbnlbXTtcblxuICBAT3V0cHV0KClcbiAgcGxhY2VTZWxlY3Q6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgQE91dHB1dCgpXG4gIHN1Z2dlc3Rpb25zQ2hhbmdlOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIGNvbnN0cnVjdG9yKEBJbmplY3QoR0VPQVBJRllfQ09ORklHKSBwcml2YXRlIGNvbmZpZzogR2VvYXBpZnlDb25maWcpIHsgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuXG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgY29uc3Qgb3B0aW9uczogR2VvY29kZXJBdXRvY29tcGxldGVPcHRpb25zID0ge307XG5cbiAgICBpZiAodGhpcy5wbGFjZWhvbGRlcikge1xuICAgICAgb3B0aW9ucy5wbGFjZWhvbGRlciA9IHRoaXMucGxhY2Vob2xkZXI7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudHlwZSkge1xuICAgICAgb3B0aW9ucy50eXBlID0gdGhpcy50eXBlO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmxhbmcpIHtcbiAgICAgIG9wdGlvbnMubGFuZyA9IHRoaXMubGFuZztcbiAgICB9XG5cbiAgICBpZiAodGhpcy5saW1pdCkge1xuICAgICAgb3B0aW9ucy5saW1pdCA9IHRoaXMubGltaXQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZGVib3VuY2VEZWxheSkge1xuICAgICAgb3B0aW9ucy5kZWJvdW5jZURlbGF5ID0gdGhpcy5kZWJvdW5jZURlbGF5O1xuICAgIH1cblxuICAgIGlmICh0aGlzLnNraXBJY29ucykge1xuICAgICAgb3B0aW9ucy5za2lwSWNvbnMgPSB0aGlzLnNraXBJY29ucztcbiAgICB9XG5cbiAgICBpZiAodGhpcy5za2lwRGV0YWlscykge1xuICAgICAgb3B0aW9ucy5za2lwRGV0YWlscyA9IHRoaXMuc2tpcERldGFpbHM7XG4gICAgfVxuXG4gICAgdGhpcy5hdXRvY29tcGxldGUgPSBuZXcgR2VvY29kZXJBdXRvY29tcGxldGUodGhpcy5jb250YWluZXIubmF0aXZlRWxlbWVudCwgdGhpcy5jb25maWcuYXBpS2V5LCBvcHRpb25zKTtcblxuICAgIGlmICh0aGlzLnZhbHVlKSB7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb3VudHJ5Q29kZXMpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIldBUk5JTkchIE9ic29sZXRlIGZ1bmN0aW9uIGNhbGxlZC4gVGhlICAnY291bnRyeUNvZGVzJyBpbnB1dCBoYXMgYmVlbiBkZXByZWNhdGVkLCBwbGVhc2UgdXNlIHRoZSBuZXcgJ2ZpbHRlckJ5Q291bnRyeUNvZGUnIGlucHV0IGluc3RlYWQhXCIpO1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkRmlsdGVyQnlDb3VudHJ5KHRoaXMuY291bnRyeUNvZGVzKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wb3NpdGlvbikge1xuICAgICAgY29uc29sZS53YXJuKFwiV0FSTklORyEgT2Jzb2xldGUgZnVuY3Rpb24gY2FsbGVkLiBUaGUgICdwb3NpdGlvbicgaW5wdXQgaGFzIGJlZW4gZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSB0aGUgbmV3ICdiaWFzQnlMb2NhdGlvbicgaW5wdXQgaW5zdGVhZCFcIik7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5hZGRCaWFzQnlQcm94aW1pdHkodGhpcy5wb3NpdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZmlsdGVyQnlDaXJjbGUpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLmFkZEZpbHRlckJ5Q2lyY2xlKHRoaXMuZmlsdGVyQnlDaXJjbGUpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmZpbHRlckJ5Q291bnRyeUNvZGUpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLmFkZEZpbHRlckJ5Q291bnRyeSh0aGlzLmZpbHRlckJ5Q291bnRyeUNvZGUpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmZpbHRlckJ5UmVjdCkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkRmlsdGVyQnlSZWN0KHRoaXMuZmlsdGVyQnlSZWN0KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5iaWFzQnlDaXJjbGUpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLmFkZEJpYXNCeUNpcmNsZSh0aGlzLmJpYXNCeUNpcmNsZSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYmlhc0J5UmVjdCkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkQmlhc0J5UmVjdCh0aGlzLmJpYXNCeVJlY3QpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmJpYXNCeVByb3hpbWl0eSkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkQmlhc0J5UHJveGltaXR5KHRoaXMuYmlhc0J5UHJveGltaXR5KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5iaWFzQnlDb3VudHJ5Q29kZSkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkQmlhc0J5Q291bnRyeSh0aGlzLmJpYXNCeUNvdW50cnlDb2RlKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wcmVwcm9jZXNzaW5nSG9vaykge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuc2V0UHJlcHJvY2Vzc0hvb2sodGhpcy5wcmVwcm9jZXNzaW5nSG9vayk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucG9zdHByb2Nlc3NpbmdIb29rKSB7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5zZXRQb3N0cHJvY2Vzc0hvb2sodGhpcy5wb3N0cHJvY2Vzc2luZ0hvb2spO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnN1Z2dlc3Rpb25zRmlsdGVyKSB7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5zZXRTdWdnZXN0aW9uc0ZpbHRlcih0aGlzLnN1Z2dlc3Rpb25zRmlsdGVyKTtcbiAgICB9XG5cbiAgICB0aGlzLmF1dG9jb21wbGV0ZS5vbignc2VsZWN0JywgdGhpcy5vblNlbGVjdC5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmF1dG9jb21wbGV0ZS5vbignc3VnZ2VzdGlvbnMnLCB0aGlzLm9uU3VnZ2VzdGlvbnMuYmluZCh0aGlzKSk7XG4gIH1cblxuICBvblNlbGVjdCh2YWx1ZTogYW55KSB7XG4gICAgdGhpcy5wbGFjZVNlbGVjdC5lbWl0KHZhbHVlKTtcbiAgfVxuXG4gIG9uU3VnZ2VzdGlvbnModmFsdWU6IGFueSkge1xuICAgIHRoaXMuc3VnZ2VzdGlvbnNDaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG5cbiAgICBpZiAoIXRoaXMuYXV0b2NvbXBsZXRlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXNbJ3ZhbHVlJ10gJiZcbiAgICAgICFjaGFuZ2VzWyd2YWx1ZSddLmlzRmlyc3RDaGFuZ2UoKSkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuc2V0VmFsdWUoY2hhbmdlc1sndmFsdWUnXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWyd0eXBlJ10gJiZcbiAgICAgICFjaGFuZ2VzWyd0eXBlJ10uaXNGaXJzdENoYW5nZSgpKSB7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5zZXRUeXBlKGNoYW5nZXNbJ3R5cGUnXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydsYW5nJ10gJiZcbiAgICAgICFjaGFuZ2VzWydsYW5nJ10uaXNGaXJzdENoYW5nZSgpKSB7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5zZXRMYW5nKGNoYW5nZXNbJ2xhbmcnXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydmaWx0ZXJCeUNpcmNsZSddICYmXG4gICAgICAhY2hhbmdlc1snZmlsdGVyQnlDaXJjbGUnXS5pc0ZpcnN0Q2hhbmdlKCkpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLmFkZEZpbHRlckJ5Q2lyY2xlKGNoYW5nZXNbJ2ZpbHRlckJ5Q2lyY2xlJ10uY3VycmVudFZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlc1snZmlsdGVyQnlDb3VudHJ5Q29kZSddICYmXG4gICAgICAhY2hhbmdlc1snZmlsdGVyQnlDb3VudHJ5Q29kZSddLmlzRmlyc3RDaGFuZ2UoKSkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkRmlsdGVyQnlDb3VudHJ5KGNoYW5nZXNbJ2ZpbHRlckJ5Q291bnRyeUNvZGUnXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydmaWx0ZXJCeVJlY3QnXSAmJlxuICAgICAgIWNoYW5nZXNbJ2ZpbHRlckJ5UmVjdCddLmlzRmlyc3RDaGFuZ2UoKSkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkRmlsdGVyQnlSZWN0KGNoYW5nZXNbJ2ZpbHRlckJ5UmVjdCddLmN1cnJlbnRWYWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXNbJ2JpYXNCeUNpcmNsZSddICYmXG4gICAgICAhY2hhbmdlc1snYmlhc0J5Q2lyY2xlJ10uaXNGaXJzdENoYW5nZSgpKSB7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5hZGRCaWFzQnlDaXJjbGUoY2hhbmdlc1snYmlhc0J5Q2lyY2xlJ10uY3VycmVudFZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlc1snYmlhc0J5UmVjdCddICYmXG4gICAgICAhY2hhbmdlc1snYmlhc0J5UmVjdCddLmlzRmlyc3RDaGFuZ2UoKSkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuYWRkQmlhc0J5UmVjdChjaGFuZ2VzWydiaWFzQnlSZWN0J10uY3VycmVudFZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlc1snYmlhc0J5UHJveGltaXR5J10gJiZcbiAgICAgICFjaGFuZ2VzWydiaWFzQnlQcm94aW1pdHknXS5pc0ZpcnN0Q2hhbmdlKCkpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLmFkZEJpYXNCeVByb3hpbWl0eShjaGFuZ2VzWydiaWFzQnlQcm94aW1pdHknXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydiaWFzQnlDb3VudHJ5Q29kZSddICYmXG4gICAgICAhY2hhbmdlc1snYmlhc0J5Q291bnRyeUNvZGUnXS5pc0ZpcnN0Q2hhbmdlKCkpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLmFkZEJpYXNCeUNvdW50cnkoY2hhbmdlc1snYmlhc0J5Q291bnRyeUNvZGUnXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydjb3VudHJ5Q29kZXMnXSAmJlxuICAgICAgIWNoYW5nZXNbJ2NvdW50cnlDb2RlcyddLmlzRmlyc3RDaGFuZ2UoKSkge1xuICAgICAgY29uc29sZS53YXJuKFwiV0FSTklORyEgT2Jzb2xldGUgZnVuY3Rpb24gY2FsbGVkLiBUaGUgICdjb3VudHJ5Q29kZXMnIGlucHV0IGhhcyBiZWVuIGRlcHJlY2F0ZWQsIHBsZWFzZSB1c2UgdGhlIG5ldyAnZmlsdGVyQnlDb3VudHJ5Q29kZScgaW5wdXQgaW5zdGVhZCFcIik7XG4gICAgICB0aGlzLmF1dG9jb21wbGV0ZS5hZGRGaWx0ZXJCeUNvdW50cnkoY2hhbmdlc1snY291bnRyeUNvZGVzJ10uY3VycmVudFZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlc1sncG9zaXRpb24nXSAmJlxuICAgICAgIWNoYW5nZXNbJ3Bvc2l0aW9uJ10uaXNGaXJzdENoYW5nZSgpKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJXQVJOSU5HISBPYnNvbGV0ZSBmdW5jdGlvbiBjYWxsZWQuIFRoZSAgJ3Bvc2l0aW9uJyBpbnB1dCBoYXMgYmVlbiBkZXByZWNhdGVkLCBwbGVhc2UgdXNlIHRoZSBuZXcgJ2JpYXNCeUxvY2F0aW9uJyBpbnB1dCBpbnN0ZWFkIVwiKTtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLmFkZEJpYXNCeVByb3hpbWl0eShjaGFuZ2VzWydwb3NpdGlvbiddLmN1cnJlbnRWYWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXNbJ2xpbWl0J10gJiZcbiAgICAgICFjaGFuZ2VzWydsaW1pdCddLmlzRmlyc3RDaGFuZ2UoKSkge1xuICAgICAgdGhpcy5hdXRvY29tcGxldGUuc2V0TGltaXQoY2hhbmdlc1snbGltaXQnXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydwcmVwcm9jZXNzaW5nSG9vayddICYmXG4gICAgICAhY2hhbmdlc1sncHJlcHJvY2Vzc2luZ0hvb2snXS5pc0ZpcnN0Q2hhbmdlKCkpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLnNldFByZXByb2Nlc3NIb29rKGNoYW5nZXNbJ3ByZXByb2Nlc3NpbmdIb29rJ10uY3VycmVudFZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlc1sncG9zdHByb2Nlc3NpbmdIb29rJ10gJiZcbiAgICAgICFjaGFuZ2VzWydwb3N0cHJvY2Vzc2luZ0hvb2snXS5pc0ZpcnN0Q2hhbmdlKCkpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLnNldFBvc3Rwcm9jZXNzSG9vayhjaGFuZ2VzWydwb3N0cHJvY2Vzc2luZ0hvb2snXS5jdXJyZW50VmFsdWUpO1xuICAgIH1cblxuICAgIGlmIChjaGFuZ2VzWydzdWdnZXN0aW9uc0ZpbHRlciddICYmXG4gICAgICAhY2hhbmdlc1snc3VnZ2VzdGlvbnNGaWx0ZXInXS5pc0ZpcnN0Q2hhbmdlKCkpIHtcbiAgICAgIHRoaXMuYXV0b2NvbXBsZXRlLnNldFN1Z2dlc3Rpb25zRmlsdGVyKGNoYW5nZXNbJ3N1Z2dlc3Rpb25zRmlsdGVyJ10uY3VycmVudFZhbHVlKTtcbiAgICB9XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmF1dG9jb21wbGV0ZS5vZmYoJ3NlbGVjdCcsIHRoaXMub25TZWxlY3QpO1xuICAgIHRoaXMuYXV0b2NvbXBsZXRlLm9mZignc3VnZ2VzdGlvbnMnLCB0aGlzLm9uU3VnZ2VzdGlvbnMpO1xuICB9XG59Il19